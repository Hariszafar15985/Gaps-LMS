function _createForOfIteratorHelper(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var a=0,i=function(){};return{s:i,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,r=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw r}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function updateFITBPreviewAttrib(t,e){var n=$(".el_".concat(e)).find("div.preview_div");$answerElem=$('input[name="answer['.concat(t,']"]'),n);var a=$answerElem.val(),i="data-answer_".concat(t);n&&n.attr(i,a)}function addPair(t,e){var n=null;if(n=parseInt(t)>0?$(".el_".concat(t)):$(".".concat(t)),pairIdentifierEl=$("input[name='pairIdentifier']",n),pairIdentifier=parseInt(pairIdentifierEl.val()),pairIdentifier++,"text"===e){var a='<div class="col-3 pair_container">\n            <div id="pair_'.concat(pairIdentifier,'" class="row matchingPair">\n                <div class="col-12">\n                <button type="button" class="removePair-btn btn btn-sm btn-background-transparent text-danger position-absolute" title="Remove Pair" onclick="removePair(').concat(pairIdentifier,", ").concat(t,')" style="right:0; height:1em; font-size:1.5em"><span aria-hidden="true">&times;</span></button>\n                    <div class="form-group">\n                        <label class="input-label">').concat(quizPairTextLabel,'</label>\n                        <input type="text" name="answers[').concat(pairIdentifier,'][text]" class="form-control" required value="" />\n                    </div>\n                    <div class="form-group">\n                        <label class="input-label">').concat(quizPairDescriptionLabel,'</label>\n                        <textarea type="text" name="answers[').concat(pairIdentifier,'][description]" class="form-control" required ></textarea>\n                    </div>\n                </div>\n            </div>\n        </div>');$(".matchingPairs",n).append(a)}else{var i='<div class="col-3 pair_container">\n            <div id="pair_'.concat(pairIdentifier,'" class="row matchingPair">\n                <div class="col-12">\n                <button type="button" class="removePair-btn btn btn-sm btn-background-transparent text-danger position-absolute" title="Remove Pair" onclick="removePair(').concat(pairIdentifier,", ").concat(t,')" style="right:0; height:1em; font-size:1.5em"><span aria-hidden="true">&times;</span></button>\n                    <div class="form-group">\n                        <label class="input-label">').concat(quizPairImageLabel,'</label>\n                        <div class="dropzone mx-auto">\n                            <img src="/assets/default/img/upload.svg" id="preview_').concat(pairIdentifier,'" required class="upload-icon" />\n                            <input type="file" id="file_').concat(pairIdentifier,'" onchange="handleFileSelect(this, this.closest(\'.matchingListImageQuestionModal_modal\') )" accept="image/*" name="answers[').concat(pairIdentifier,'][file]" required class="upload-input cursor-pointer" />\n                            <input type="hidden" name="answers[').concat(pairIdentifier,'][image]" id="image_').concat(pairIdentifier,'" required value="" />\n                        </div>\n                    </div>\n                    <div class="form-group">\n                        <label class="input-label">').concat(quizPairTextLabel,'</label>\n                        <input type="text" name="answers[').concat(pairIdentifier,'][text]" class="form-control" required />\n                    </div>\n                </div>\n            </div>\n        </div>');$(".matchingPairs",n).append(i)}pairIdentifierEl.val(pairIdentifier)}function removePair(t,e){var n=null;n=parseInt(e)>0?$(".el_".concat(e)):$(".".concat(e)),console.log(n);var a=$("#pair_".concat(t),n);console.log(a),a.closest(".pair_container").remove()}function handleFileSelect(t,e){var n=t.id,a=n.replace("file","image"),i=n.replace("file","preview");console.log(e);var r=$("#".concat(a),e),o=$("#".concat(i),e);console.log(r);var c=t.files[0],l=c.type,s=new FileReader;s.onload=function(t){var e=t.target.result,n=window.btoa(e),a="data:".concat(l,";base64,").concat(n);console.log(a),r.val("".concat(a)),o.attr("src","".concat(a)),o.removeClass("upload-icon"),o.addClass("my-auto")},s.readAsBinaryString(c)}!function(t){"use strict";function e(){for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",n=0;n<5;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}function n(e){return t.summernote.ui.button({contents:'<i class="fa fa-minus fa-2x"></i>&nbsp;Blank',tooltip:"Insert Blank",click:function(){e.invoke("editor.insertText","{blank}")}}).render()}t("body").on("click","#add_multiple_question",function(n){n.preventDefault();var a=t("#multipleQuestionModal").clone(),i="correctAnswerSwitch"+e();a.find("label.js-switch").attr("for",i),a.find("input.js-switch").attr("id",i);var r=e();a.find(".panel-file-manager").attr("data-input",r),a.find(".lfm-input").attr("id",r),a.find(".main-answer-row").removeClass("main-answer-row").addClass("main-answer-box"),Swal.fire({html:a.html(),showCancelButton:!1,showConfirmButton:!1,customClass:{content:"p-0 text-left"},width:"48rem"})}),t("body").on("click",".add-answer-btn",function(n){n.preventDefault();var a=t(".add-answer-container .main-answer-box"),i=a.clone();i.removeClass("main-answer-box"),i.find(".answer-remove").removeClass("d-none");var r="correctAnswerSwitch"+e();i.find("label.js-switch").attr("for",r),i.find("input.js-switch").attr("id",r);var o=e();i.find(".panel-file-manager").attr("data-input",o),i.find(".lfm-input").attr("id",o),i.find('input[type="checkbox"]').prop("checked",!1);var c=i.prop("innerHTML"),l=e();c=(c=c.replace(/\[record\]/g,"["+l+"]")).replace(/\[\d+\]/g,"["+l+"]"),i.html(c),i.find('input[type="checkbox"]').prop("checked",!1),i.find('input[type="text"]').val(""),a.parent().append(i)}),t("body").on("click",".answer-remove",function(e){e.preventDefault(),t(this).closest(".add-answer-card").remove()}),t("body").on("click","#add_descriptive_question",function(e){e.preventDefault();var n=t("#descriptiveQuestionModal").clone();Swal.fire({html:n.html(),showCancelButton:!1,showConfirmButton:!1,customClass:{content:"p-0 text-left"},width:"48rem"})}),t("body").on("click","#add_fillInBlank_question",function(e){e.preventDefault();var a=Math.floor((new Date).getTime()/1e3),i=t(this).attr("data-quiz-id"),r=t(".fillBlankQuestionModal"+i).clone();console.log(".fillBlankQuestionModal"+i),Swal.fire({html:r.html(),showCancelButton:!1,showConfirmButton:!1,customClass:{content:"p-0 text-left el_".concat(a)},width:"60%"}),t(".el_".concat(a," .note-editor.note-frame.card")).remove(),t("textarea.summernote").summernote({height:150,spellCheck:!0,toolbar:[["style",["bold","italic","underline","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["view",["codeview"]],["custom",["insertBlank"]]],buttons:{insertBlank:n},callbacks:{onChange:function(e){for(var n=0,i=t(".el_".concat(a)).find("div.preview_div");e.indexOf("{blank}")>-1;){var r={name:"answer[".concat(n,"]"),id:"answer_".concat(n)},o="data-answer_".concat(n),c="";i.attr(o)&&(c=i.attr(o)),e=e.replace("{blank}",' <input type="text" onkeyup="updateFITBPreviewAttrib('.concat(n,", ").concat(a,')" name="').concat(r.name,'" id="').concat(r.id,'" class="form-control blankInput" value="').concat(c,'" />')),n++}i.html(e)}}})}),t("body").on("click","#add_fileUpload_question",function(e){e.preventDefault();var n=Math.floor((new Date).getTime()/1e3),a=t(this).attr("data-quiz-id"),i=t(".fileUploadQuestionModal"+a).clone();Swal.fire({html:i.html(),showCancelButton:!1,showConfirmButton:!1,customClass:{content:"p-0 text-left el_".concat(n)},width:"60%"})}),t("body").on("click","#add_matchingListText_question",function(e){e.preventDefault();var n=Math.floor((new Date).getTime()/1e3),a=t(this).attr("data-quiz-id"),i=t(".matchingListTextQuestionModal"+a).clone();Swal.fire({html:i.html(),showCancelButton:!1,showConfirmButton:!1,customClass:{content:"p-0 text-left el_".concat(n)},width:"60%"}),t("body").on("click",".el_".concat(n," #add_text_pair"),function(t){addPair(n,"text")})}),t("body").on("click","#add_matchingListImage_question",function(e){e.preventDefault();var n=Math.floor((new Date).getTime()/1e3),a=t(this).attr("data-quiz-id"),i=t(".matchingListImageQuestionModal"+a).clone();Swal.fire({html:i.html(),showCancelButton:!1,showConfirmButton:!1,customClass:{content:"p-0 text-left el_".concat(n)},width:"60%"}),t("body").on("click",".el_".concat(n," #add_image_pair"),function(t){addPair(n,"image")})}),t("body").on("change",".js-switch",function(){var e=t(this);e.closest(".js-switch-parent");this.checked&&(t(".js-switch").each(function(){t(this).closest(".js-switch-parent").find('input[type="checkbox"]').prop("checked",!1)}),e.prop("checked",!0))}),t("body").on("click",".save-question",function(e){e.preventDefault();var n=t(this),a=n.closest("form"),i=a.serializeObject(),r=a.attr("action"); n.addClass("loadingbar primary").prop("disabled",!0),a.find("input").removeClass("is-invalid"),a.find("textarea").removeClass("is-invalid"),t.post(r,i,function(t){t&&200===t.code&&(Swal.fire({icon:"success",html:'<h3 class="font-20 text-center text-dark-blue py-25">'+saveSuccessLang+"</h3>",showConfirmButton:!1,width:"25rem"}),setTimeout(function(){window.location.reload()},500))}).fail(function(t){n.removeClass("loadingbar primary").prop("disabled",!1);var e=t.responseJSON;e&&e.errors&&Object.keys(e.errors).forEach(function(t){var n=e.errors[t],i=a.find('[name="'+t+'"]');i.addClass("is-invalid"),i.parent().find(".invalid-feedback").text(n[0])})})}),t("body").on("click",".edit_question",function(a){a.preventDefault();var i=t(this).attr("data-question-id"),r=Math.floor((new Date).getTime()/1e3);loadingSwl(),t.get("/admin/quizzes-questions/"+i+"/edit",function(a){if(a&&a.html){var i='<div id="editQuestion">'+a.html+"</div>";Swal.fire({html:i,showCancelButton:!1,showConfirmButton:!1,customClass:{content:"p-0 text-left el_".concat(r)},width:"48rem",onOpen:function(){var n=t("#editQuestion");n.find(".main-answer-row").removeClass("main-answer-row").addClass("main-answer-box");var a=e();n.find(".panel-file-manager").first().attr("data-input",a),n.find(".lfm-input").first().attr("id",a);var i="correctAnswerSwitch"+e();n.find("label.js-switch").first().attr("for",i),n.find("input.js-switch").first().attr("id",i)}}),i.indexOf("fillBlankQuestionModal")&&i.indexOf("summernote")>-1&&(t("textarea.summernote").summernote({height:150,spellCheck:!0,toolbar:[["style",["bold","italic","underline","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["view",["codeview"]],["custom",["insertBlank"]]],buttons:{insertBlank:n},callbacks:{onChange:function(e){for(var n=0,a=t(".el_".concat(r)).find("div.preview_div");e.indexOf("{blank}")>-1;){var i={name:"answer[".concat(n,"]"),id:"answer_".concat(n)},o="data-answer_".concat(n),c="";a.attr(o)&&(c=a.attr(o)),e=e.replace("{blank}",' <input type="text" onkeyup="updateFITBPreviewAttrib('.concat(n,", ").concat(r,')" name="').concat(i.name,'" id="').concat(i.id,'" class="form-control blankInput" value="').concat(c,'" />')),n++}a.html(e)},onInit:function(){var e=0,n=t(".el_".concat(r)),a=t(".summernote",n).val(),i=n.find("div.preview_div");for(console.log(n,a,i);a.indexOf("{blank}")>-1;){var o={name:"answer[".concat(e,"]"),id:"answer_".concat(e)},c="data-answer_".concat(e),l="";i.attr(c)&&(l=i.attr(c)),a=a.replace("{blank}",' <input type="text" onkeyup="updateFITBPreviewAttrib('.concat(e,", ").concat(r,')" name="').concat(o.name,'" id="').concat(o.id,'" class="form-control blankInput" value="').concat(l,'" />')),e++}i.html(a)}}}),t("textarea.summernote").trigger("summernote.change"))}})}),t("body").on("change",".js-quiz-question-locale",function(e){e.preventDefault();var n=t(this),a=t(this).closest("form"),i=n.val(),r=n.attr("data-id");n.addClass("loadingbar gray");var o="/admin/quizzes-questions/"+r+"/getQuestionByLocale?locale="+i;t.get(o,function(e){var i=e.question;if("descriptive"===i.type){var r=["title","correct"];Object.keys(i).forEach(function(e){var n=i[e];-1!==t.inArray(e,r)&&a.find('[name="'+e+'"]').val(n)})}else if(a.find('[name="title"]').val(i.title),i.quizzes_questions_answers&&i.quizzes_questions_answers.length){var o,c=_createForOfIteratorHelper(i.quizzes_questions_answers);try{for(c.s();!(o=c.n()).done;){var l=o.value;l&&a.find(".js-ajax-answer-title-"+l.id).val(l.title)}}catch(t){c.e(t)}finally{c.f()}}n.removeClass("loadingbar gray")}).fail(function(t){n.removeClass("loadingbar gray")})})}(jQuery);

$("body").on("click", "#add_infoText_question", function(e) {
    e.preventDefault();
    let swalIdentifier = Math.floor(new Date().getTime() / 1000);
    var informativeQuestionModal = $(".informativeQuestionModal");
    var clone = informativeQuestionModal.clone();
    Swal.fire({
        html: clone.html(),
        showCancelButton: false,
        showConfirmButton: false,
        customClass: {
            content: `p-0 text-left el_${swalIdentifier}`
        },
        width: "48rem"
    });

    /* remove any previous note editor created by summernote */
    $(`.el_${swalIdentifier} .note-editor.note-frame.card`).remove();
    $("textarea.summernote").summernote({
        /* set editable area's height */
        height: 150,
        spellCheck: true,
        toolbar: [
            ["style", ["bold", "italic", "underline", "clear"]],
            ["color", ["color"]],
            ["para", ["ul", "ol", "paragraph"]],
            ["view", ["codeview"]]
        ],
        callbacks: {
            onChange: function(contents) {
                let answersCountFITB = 0;
                let parentContainer = $(`.el_${swalIdentifier}`);
                let previewElem = parentContainer.find("div.preview_div");
                previewElem.html(contents);
            }
        }
    });
});
